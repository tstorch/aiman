#!/usr/bin/env bash
set -euo pipefail

DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
SCRIPTS="$DIR/../scripts"

cmd="${1:-}"; shift || true
case "$cmd" in
  new) bash "$SCRIPTS/new-entity.sh" "$@";;
  index) bash "$SCRIPTS/update-index.sh";;
  status) bash "$SCRIPTS/update-status.sh";;
  reflect) bash "$SCRIPTS/reflect.sh" "$@";;
  sync) bash "$SCRIPTS/sync.sh";;
  prompt)
    # Usage: bin/aiman prompt --agent <copilot|claude|openai|goose> --task <task> [--context files]
    bash "$SCRIPTS/agents/common/render-prompt.sh" "$@";;
  prompt-install)
    # Usage: bin/aiman prompt-install --agent <copilot|claude|openai|goose> --task <task> [--context files]
    bash "$SCRIPTS/agents/common/install-prompt.sh" "$@";;
  *)
    cat <<EOF
Aiman CLI
Usage: bin/aiman <command> [args]
Commands:
  new <type> "<title>" [options]  # neues Artefakt
  index                            # Index/Graph aktualisieren
  status                           # Status aktualisieren
  reflect <path-or-id>             # ACE-Reflexion anlegen
  sync                             # Index + Status aktualisieren
  prompt --agent A --task T [--context f1,f2]  # Render Prompt f√ºr Agent/Task
  prompt-install --agent A --task T [--context f1,f2]  # Prompt exportieren + Clipboard
EOF
    ;;
 esac
